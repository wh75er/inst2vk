## INST2VK

**INST2VK** - это удобная утилита, которая позволяет автоматически экспортировать контент из инстаграмма в сообщество вконтакте.

## Table of Contents

* [Introduction](#introduction)
* [Как это работает](#как-это-работает)

## Introduction

Основной задачей данной утилиты является выгрузка контента из инстаграмм профилей с возможностью экспорта на другие платформы(для начала только сообщества вконтакте)

## Как это работает

**Instagram API**
Так как instagram API на данный момент( конец 2019 года) не стабилен, используется source code страницы. Из него вытаскиваются все посты, которые находятся в профиле. Поэтому никаких дополнительных манипуляций с токенами и т.п. проводить не нужно

**VK API**
Для VK API требуется специальный токен, который генерируется на офф. странице сайта и записывается в специальный файл, предназначенный для токена. Далее никаких дополнительных манипуляций проводить с VK API не нужно

**Конфиг файл**
В конфиг файле будут использоваться специальные параметры для конфигурации программы, например:
initiate on
Включает инициализацию. Это значит, что программа запущена в первый раз и сообщество(или платформа) требует какого-нибудь начального заполнения. Эта опция постит первые 10 постов из предложенного списка url инстаграм профилей. 

**Входные данные**
Для работы программы требуется 3 доп.файла:
* Файл с конфигом
* Файл со списком url instagram профилей
* Файл с токеном для VK API

**Последовательность работы программы**
1. Проверка всех параметров в конфиге(Предполагается, что есть структура со всеми дефолтными параметрами, но если в конфиге параметр не совпадает с уже определнным(дефолтным), то он перезаписывается)
2. Обработка параметров конфигов( Например, если параметр initiate выставлен в on, то подключится модуль, который проведет инициализацию. Затем этот параметр в конфиге переставится в off, по умолчанию и программа завершит работу)
3. Если после обработки параметров конфига, программа не завершила свою работу, то далее идет обработка всех профилей инстаграма из списка URL'ов(далее на примере одного профиля)
4. Берется ссылка последнего поста и открывается. Выбирается дата отправления поста. Если она совпадает с сегодняшней, то данный пост подходит и заносится в список готовых постов на постинг(Эта структура состоит из объектов, в которых указывается номер картинки, например "1.jpg" и информация о том, кто постил - id профиля и возможный автор картинки, если он указан в комментариях под постом, получается список строк, состоящий из 1-2 элементов contacts=["@owner", "@author?"]), картинка сохраняется под номером появления в специальной папке. Данный шаг повторяется для еще 3(default) постов, пока не будет встречена "не свежая дата". Это делается на случай, если автор запостил несколько картинок за день. Разумеется, если он за день запостил больше 3 записей, то не все будут обработаны.(чтобы этого избежать, можно поставить значения обработки постов больше <-! **Можно ввести это как отдельный параметр в конфиге**)
5. Далее шаг 4 повторяется для всех оставшихся профилей в списке.
6. Список с взятыми постами перемешивается в рандомном порядке и выставляет их на постинг в schedule с интервалом в 1 час( при том первую картинку постит сразу). Таким образом огромное количество картинок не будет поститься сразу в один момент, если таковых больше 1. **Мб стоит придумать другуй систему, чтобы они постились равномерно на протяжении дня в зависимости от количества**
7. В конце работы, программа удаляет временные файлы: все скачанные картинки.
8. В конце всех этих действий программа завершает свои работу и запускается в следующий раз с помощью демона в системе, например с помощью **crond**, раз в сутки, в конце дня, например в 11:30.

**Ньюансы**
1. Придумать как вытаскивать картинки из постов с серией фотографий;
2. Есть ли у VK API возможность schedule'а постинга для ботов;
3. Можно ли вытаскивать картинки из source code'a в инстаграме.
